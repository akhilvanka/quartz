<!DOCTYPE html>
<html lang="en">
{{ partial "head.html" . }}

<body>
{{partial "search.html" .}}
<div class="index delay t-3">
    <header>
        <h1>{{if .Title}}{{ .Title }}{{else}}Untitled{{end}}</h1>
        <svg tabindex="0" id="search-icon" aria-labelledby="title desc" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7"><title id="title">Search Icon</title><desc id="desc">Icon to open search</desc><g class="search-path" fill="none"><path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"/><circle cx="8" cy="8" r="7"/></g></svg>
        <div class="spacer"></div>
        {{partial "darkmode.html" .}}
    </header>
</div>
<div class="index">
    <div class="bio">
        <article>
            <p>Hello there, <span class="return-only"> Welcome back! </span> My Name is Akhil</p>
            <div class="delay stagger">{{- .Content -}}</div>
        </article>
        <ul class="delay t-4 stagger">
            <h2>Recent Notes</h2>
            {{range first 8 .Site.RegularPages }}
            <li class="section-li">
                <div class="section">
                    <div class="desc">
                        <h3><a href="{{ .Permalink }}">{{- .Title -}}</a></h3>
                    </div>
                    <p class="meta">
                        {{.WordCount}} words. {{if ne .Date .Lastmod}}{{ .Lastmod.Format "January 2, 2006" }}{{else}}Unknown{{end}}
                    </p>
                </div>
            </li>
            {{end}}
        </ul>
        <textarea rows=40 cols=75 id="output" style="border:0;font-family:monospace"></textarea>
    </div>
    <div class="delay t-4">
        {{partial "footer.html" .}}
    </div>
</div>
<script>

// inspired by https://p.teknik.io/Raw/EWWzQ
// and https://www.reddit.com/r/unixporn/comments/amdt7m/2bwm_cat/

var output = document.getElementById("output");

var rows=45
var cols=75
var grid

var branches = 0
var max_branches = 1024

var t = 50

function init() {
grid=[]
for(var row = 0; row < rows; row++) {
  grid.push([])
  for(var col = 0; col < cols; col++) {
    grid[row].push(" ")
  }
}

}

function show(){

	var str = getString()


	output.value = str

}

function getString(){
  str = ""
  for(var row = 0; row < rows; row++) {
    str += grid[row].join("") +"\n";
  }
  return str
}

function bonsai(){
init()
grow()
//show()
}

bonsai()

function grow() {
	var start = int(cols / 2) //+ rand(-1*cols/3, 2*cols / 3)

	var x = start;
	var y = rows - 3;
  var life = 30
  //branch(x,y,life)
  window.setTimeout(function(){step(x,y,life)},400);
  //grid[y][x] = "|"
}


function nextTimeT(){
  t += 2;
  return t;
}

function nextTime(){
  return 1+Math.floor(nextTimeT()/5)
}



function step(x,y,life){
  if(life<1){
    return
  }

    var dy = (rand(0,10) > 3) ? -1 : 0
    var dx = rand(-2,2)

    if(branches < max_branches){
      //if(rand(0,10)<2) { branch(x,y,life) }
      //if(rand(0,20) + life < 15) { branch(x,y,life) }
      if(life%13==0 || rand(0,40)<2 || life < 5){

      //var f= life*life * rand(0,10)
      //if(f < 500 || life < 2){

      //if(life%15==0){
        branches++
        window.setTimeout(function(){step(x,y,life-1)},t+rand(1,11))
        //step(x,y,life-1)

      }
    }

    x += dx
    y += dy

    var char = (dx > 0) ?  "/" : "\\"
    if (dx == 0) { char = "|" }
    if (dy == 0) { char = "~" }
    if (life==1) { char = "&"}

    if(x<0||x>rows-1||y<0){return}
    grid[y][x] = char
    show()
    if(life>0){

      window.setTimeout(function(){step(x,y,life-1)},t+rand(1,11))
      //step(x,y,life-1)
    }
}

function rand(min,max){
	return int(min + Math.random() * (Math.abs(min)+max))
}

function int(float){
	return Math.round(float) // yea i know
}

</script>
</body>
</html>
